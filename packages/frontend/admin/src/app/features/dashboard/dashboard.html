<div class="dashboard-page animate-fade-in">
  <div class="page-header" appDraggableResizable="dashboard-header">
    <div class="header-content">
      <h2>System Dashboard</h2>
      <p class="text-muted">Real-time monitoring and analytics for infrastructure performance</p>
    </div>
  </div>

  <div class="dashboard-container">
    <div class="stats-grid">
      @for (metric of getDisplayMetrics(); track metric.name; let i = $index) {
        <div
          class="stat-card glass animate-slide-up"
          [style.animation-delay.s]="i * 0.1"
          [appDraggableResizable]="'dashboard-stat-' + i"
        >
          <div
            class="stat-icon"
            [ngClass]="getMetricIconClass(metric.name)"
            [style]="getMetricIconStyle(metric.name)"
          >
            <span class="material-icons">{{ getMetricIcon(metric.name) }}</span>
          </div>
          <div class="stat-content">
            <span class="stat-label">{{ metric.name }}</span>
            <h2 class="stat-value">
              {{ metric.value | number: getMetricFormat(metric.name) }}
              @if (metric.unit) {
                <span class="unit">{{ metric.unit }}</span>
              }
            </h2>
            <div class="stat-trend" [ngClass]="getMetricTrendClass(metric.name, metric.value)">
              @if (getMetricTrendIcon(metric.name)) {
                <span class="material-icons">{{ getMetricTrendIcon(metric.name) }}</span>
              }
              <span>{{ getMetricTrendText(metric.name, metric.value) }}</span>
            </div>
          </div>
        </div>
      }
    </div>

    <div class="dashboard-grid">
      @if (data()?.charts?.length) {
        <div class="charts-section animate-fade-in">
          @for (chart of data()?.charts; track chart.title; let i = $index) {
            <div class="chart-card glass" [appDraggableResizable]="'dashboard-chart-' + i">
              <div class="chart-header">
                <h4>{{ chart.title }}</h4>
                <span class="chart-type-tag">{{ chart.type }}</span>
              </div>
              <div class="chart-data-list">
                @for (entry of chart.data; track entry.label) {
                  <div class="chart-row">
                    <span class="chart-label">{{ entry.label }}</span>
                    <div class="chart-bar-container">
                      <div
                        class="chart-bar"
                        [style.width.%]="getChartBarWidth(entry.value, chart.data)"
                        [ngClass]="chart.type"
                      ></div>
                    </div>
                    <span class="chart-value">{{ entry.value }}</span>
                  </div>
                }
              </div>
            </div>
          }
        </div>
      }

      @if (data()?.alerts?.length) {
        <div class="alerts-section animate-fade-in">
          @for (alert of data()?.alerts; track alert.timestamp) {
            <div class="alerts-card glass">
              <div class="alerts-header">
                <h3>{{ alert.header }}</h3>
              </div>
              <div class="alerts-list">
                <div class="alert-item" [ngClass]="'alert-' + alert.type">
                  <div class="alert-icon">
                    <span class="material-icons">{{ getAlertIcon(alert.type) }}</span>
                  </div>
                  <div class="alert-content">
                    <h4>{{ alert.title }}</h4>
                    <p>{{ alert.message }}</p>
                    <span class="alert-time">{{ alert.timestamp | date: 'short' }}</span>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
