
<div class="settings-page animate-fade-in">
  <div class="page-header" appDraggableResizable="settings-header">
    <div class="header-content">
      <h2>System Settings</h2>
      <p class="text-muted">Configure global application behavior and security policies</p>
    </div>
    <div class="header-actions" appDraggableResizable="settings-header-actions">
      <button class="btn btn-secondary" (click)="loadSettings()" [disabled]="loading()" title="Use cached settings">
        <span class="material-icons" [class.spin]="loading()">cached</span>
        Load Settings
      </button>
      <button class="btn btn-primary" (click)="refreshSettings()" [disabled]="loading()" title="Force fresh settings">
        <span class="material-icons" [class.spin]="loading()">refresh</span>
        Refresh Settings
      </button>
    </div>
  </div>

  <app-draft-status-bar
    [config]="draftStatusConfig()"
    (saveChanges)="saveSettings()"
    (resetChanges)="resetChanges()">
  </app-draft-status-bar>

  <div class="settings-container glass" appDraggableResizable="settings-container">
    <div class="settings-section">
      <h3>General Configuration</h3>
      <div class="settings-list">
        @for (setting of settings(); track setting.id) {
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-category">{{ setting.category }}</span>
              <span class="setting-label">{{ setting.label }}</span>
              <p class="setting-desc">{{ setting.description }}</p>
            </div>
            <div class="setting-action">
              <div class="toggle-group">
                <div class="toggle-item">
                  <label>Enabled</label>
                  <app-toggle-switch 
                    [checked]="setting.isActive" 
                    [disabled]="loading()"
                    (toggleChange)="onActiveToggleChange(setting.id, $event)"
                    size="medium">
                  </app-toggle-switch>
                </div>
                <div class="toggle-item">
                  <label>Value</label>
                  <app-toggle-switch 
                    [checked]="setting.value" 
                    [disabled]="loading() || !setting.isActive"
                    (toggleChange)="onToggleChange(setting.id, $event)"
                    size="medium">
                  </app-toggle-switch>
                </div>
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>
